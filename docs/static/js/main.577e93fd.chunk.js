(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(32),i=n.n(o),s=(n(42),n(11)),l=n(12),c=n(15),h=n(13),u=n(16),m=(n(44),n(104)),d=n(20),f=n.n(d),p=n(33),g=a.a.createContext({}),v=n(35),w=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(c.a)(this,Object(h.a)(t).call(this))).state={collapsed:!0,metadataContext:{loading:!0}},e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.a.config({name:"worldevents",version:1,storeName:"worldevents",description:"worldevents"}),f.a.ready().then(function(){e.fetchMetaData()}).catch(function(e){console.log(e)})}},{key:"fetchMetaData",value:function(){this.setState({metadataContext:{loading:!1}})}},{key:"render",value:function(){return a.a.createElement(g.Provider,{value:this.state.metadataContext},a.a.createElement(m.a,null,this.state.metadataContext.loading?a.a.createElement("div",{style:{position:"absolute",top:0,width:"100%",height:350,textAlign:"center",paddingTop:150,paddingBottom:30}},a.a.createElement(p.ScaleLoader,{color:"#FFF",loading:!0})):a.a.createElement(v.a,{style:{height:"500",width:"100%"}})))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},17:function(e,t,n){"use strict";function r(e,t,n,r,a,o){o=o||window.scene;for(var i=[],s=[],l=[],c=function(e){var t=[];if("Feature"==e.type)t.push(e.geometry);else if("FeatureCollection"==e.type)for(var n=0;n<e.features.length;n++)t.push(e.features[n].geometry);else{if("GeometryCollection"!=e.type)throw new Error("The geoJSON is not valid.");for(var r=0;r<e.geometries.length;r++)t.push(e.geometries[r])}return t}(t),h=function(e){var t;if("sphere"==e)t=y;else{if("plane"!=e)throw new Error("The shape that you specified is not valid.");t=M}return t}(r),u=[],m=0;m<c.length;m++)if("Point"==c[m].type)h(c[m].coordinates,n),x(i[0],s[0],l[0],a);else if("MultiPoint"==c[m].type)for(var d=0;d<c[m].coordinates.length;d++)h(c[m].coordinates[d],n),x(i[0],s[0],l[0],a);else if("LineString"==c[m].type){u=g(c[m].coordinates);for(d=0;d<u.length;d++)h(u[d],n);E(i,s,l,a)}else if("Polygon"==c[m].type)for(var f=0;f<c[m].coordinates.length;f++){u=g(c[m].coordinates[f]);for(d=0;d<u.length;d++)h(u[d],n);E(i,s,l,a)}else if("MultiLineString"==c[m].type)for(f=0;f<c[m].coordinates.length;f++){u=g(c[m].coordinates[f]);for(d=0;d<u.length;d++)h(u[d],n);E(i,s,l,a)}else{if("MultiPolygon"!=c[m].type)throw new Error("The geoJSON is not valid.");for(var p=0;p<c[m].coordinates.length;p++)for(f=0;f<c[m].coordinates[p].length;f++){u=g(c[m].coordinates[p][f]);for(d=0;d<u.length;d++)h(u[d],n);E(i,s,l,a)}}function g(e){for(var t=[],n=[],r=0;r<e.length;r++){var a=e[r],o=e[r-1];if(r>0)if(v(o,a)){n=w(n=[o,a]);for(var i=0;i<n.length;i++)t.push(n[i])}else t.push(a);else t.push(a)}return t}function v(e,t){var n=t[0],r=t[1],a=e[0],o=e[1],i=Math.abs(n-a),s=Math.abs(r-o);return i>5||s>5}function w(e){for(var t,n,r=[],a=0;a<e.length-1;a++)t=e[a],v(n=e[a+1],t)?(r.push(t),r.push(b(t,n))):r.push(t);return r.push(e[e.length-1]),r.length>e.length?r=w(r):r}function b(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function y(e,t){var n=e[0],r=e[1];i.push(Math.cos(r*Math.PI/180)*Math.cos(n*Math.PI/180)*t),s.push(Math.cos(r*Math.PI/180)*Math.sin(n*Math.PI/180)*t),l.push(Math.sin(r*Math.PI/180)*t)}function M(e,t){var n=e[0],r=e[1];l.push(r/180*t),s.push(n/180*t)}function x(t,n,r,a){var i=new e.Geometry;i.vertices.push(new e.Vector3(t,n,r));var s=new e.ParticleSystemMaterial(a),l=new e.ParticleSystem(i,s);o.add(l),S()}function E(t,n,r,a){var i=new e.Geometry;!function(t,n,r,a){for(var o=0;o<n.length;o++)t.vertices.push(new e.Vector3(n[o],r[o],a[o]))}(i,t,n,r);var s=new e.LineBasicMaterial(a),l=new e.Line(i,s);o.add(l),S()}function S(){i.length=0,s.length=0,l.length=0}}n.d(t,"a",function(){return r})},35:function(e,t,n){"use strict";(function(e){var r=n(11),a=n(12),o=n(15),i=n(13),s=n(16),l=n(0),c=n.n(l),h=n(2),u=n(7),m=n.n(u),d=n(17),f=n(18),p=n.n(f),g=n(96),v=n(101),w=function(t){function n(){var e;return Object(r.a)(this,n),(e=Object(o.a)(this,Object(i.a)(n).call(this))).start=function(){e.frameId||(e.frameId=requestAnimationFrame(e.animate))},e.stop=function(){cancelAnimationFrame(e.frameId)},e.animate=function(){e.controls.update(),e.renderScene(),e.frameId=window.requestAnimationFrame(e.animate)},e.renderScene=function(){e.renderer.render(e.scene,e.camera)},e.state={colorBuckets:[{mm:24,rgb:[.878431,.878431,.878431]},{mm:74,rgb:[.6901,.6901,.6901]},{mm:124,rgb:[.51764,.51764,.51764]},{mm:224,rgb:[.7137,.35294,.35294]},{mm:274,rgb:[.7333,.6431,.5176]},{mm:374,rgb:[1,.7333,.3843]},{mm:474,rgb:[1,1,.2666]},{mm:724,rgb:[.5137,1,.5294]},{mm:974,rgb:[.1411,1,.0235]},{mm:1474,rgb:[.2196,.7529,.1686]},{mm:2474,rgb:[.0862,.53333,.0235]},{mm:4974,rgb:[.0549,.3686,.298]},{mm:7474,rgb:[.9843,0,1]},{mm:10004,rgb:[.4235,0,.4235]},{mm:1/0,rgb:[.0509,.44705,1]}]},e}return Object(s.a)(n,t),Object(a.a)(n,[{key:"convertToSphereCoords",value:function(e,t){var n=e[0],r=e[1];return{x:Math.cos(r*Math.PI/180)*Math.cos(n*Math.PI/180)*t,y:Math.cos(r*Math.PI/180)*Math.sin(n*Math.PI/180)*t,z:Math.sin(r*Math.PI/180)*t}}},{key:"componentDidMount",value:function(){var t=this,n=this.mount.clientWidth,r=this.mount.clientHeight;this.scene=new h.Scene,this.camera=new h.PerspectiveCamera(55,n/r,.01,100),this.renderer=new h.WebGLRenderer({antialias:!0}),this.renderer.setClearColor("#111"),this.renderer.setSize(n,r),this.mount.appendChild(this.renderer.domElement),this.planet=new h.Object3D,this.sphereGeometry=new h.SphereGeometry(10,128,128),this.material=new h.MeshBasicMaterial({color:16777215,wireframe:!1,transparent:!1}),this.sphere=new h.Mesh(this.sphereGeometry,this.material),this.planet.add(this.sphere),this.planet.rotation.x=-1.5707963259,this.camera.position.z=15,this.scene.add(this.planet),this.controls=new v(this.camera,this.renderer.domElement),this.controls.noPan=!0,this.controls.minDistance=11,this.controls.maxDistance=25;var a=this;m.a.all([m.a.get("data/ne_50m_geographic_lines.json"),m.a.get("data/ne_50m_admin_1_states_provinces_lines.json"),m.a.get("data/ne_50m_admin_0_countries.json"),m.a.get("data/rainfallannual.out",{responseType:"arraybuffer",timeout:2e4})]).then(m.a.spread(function(n,r,o,i){var s,l;a.box=new h.BoxGeometry(.05,.05,3),a.boxMaterial=new h.MeshBasicMaterial({color:65280,wireframe:!0}),a.box.applyMatrix((new h.Matrix4).makeTranslation(.025,.025,11.5));var c=new g(new e(i.data)),u=c.nextUInt32BE(),m=new Array(u);for(s=0;s<m.length;s++)m[s]=c.nextFloatBE();var f=c.nextUInt32BE(),v=new Array(f);for(l=0;l<v.length;l++)v[l]=c.nextFloatBE();var w=new h.BufferGeometry,b=new Float32Array(u*f*3*6),y=new Float32Array(u*f*3*6),M=p.a.cloneDeep(t.state.colorBuckets),x=function(e){return I<e.mm},E=0;for(s=0;s<m.length;s++)for(l=0;l<v.length;l++){var S=3*E*6,I=c.nextFloatBE(),B=p.a.find(M,x).rgb,C=m[s],P=v[l],k=a.convertToSphereCoords([P-.25,C+.25],10.01),j=a.convertToSphereCoords([P+.25,C+.25],10.01),O=a.convertToSphereCoords([P+.25,C-.25],10.01),F=a.convertToSphereCoords([P-.25,C-.25],10.01);b[S+0]=O.x,b[S+1]=O.y,b[S+2]=O.z,b[S+3]=j.x,b[S+4]=j.y,b[S+5]=j.z,b[S+6]=k.x,b[S+7]=k.y,b[S+8]=k.z,b[S+9]=k.x,b[S+10]=k.y,b[S+11]=k.z,b[S+12]=F.x,b[S+13]=F.y,b[S+14]=F.z,b[S+15]=O.x,b[S+16]=O.y,b[S+17]=O.z,y[S+0]=B[0],y[S+1]=B[1],y[S+2]=B[2],y[S+3]=B[0],y[S+4]=B[1],y[S+5]=B[2],y[S+6]=B[0],y[S+7]=B[1],y[S+8]=B[2],y[S+9]=B[0],y[S+10]=B[1],y[S+11]=B[2],y[S+12]=B[0],y[S+13]=B[1],y[S+14]=B[2],y[S+15]=B[0],y[S+16]=B[1],y[S+17]=B[2],E++}w.addAttribute("position",new h.BufferAttribute(b,3)),w.addAttribute("color",new h.BufferAttribute(y,3));var A=new h.MeshBasicMaterial({vertexColors:h.VertexColors,wireframe:!1}),_=new h.Mesh(w,A);a.planet.add(_),n.data.features=p.a.filter(n.data.features,function(e){return"Equator"===e.properties.name}),Object(d.a)(h,n.data,10.03,"sphere",{color:0},a.planet),Object(d.a)(h,r.data,10.03,"sphere",{color:0},a.planet),Object(d.a)(h,o.data,10.03,"sphere",{color:0},a.planet),a.start()}))}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("div",{style:{width:"100vw",height:"100vh"},ref:function(t){e.mount=t}}),c.a.createElement("div",{style:{position:"absolute",left:"10px",top:"10px",fontSize:"1.5em"}},"Average annual precipitation (2001-2013)"),c.a.createElement("div",{style:{position:"absolute",right:"10px",bottom:"10px",fontSize:"0.8em"}},"Lange, Stefan (2016): EartH2Observe, WFDEI and ERA-Interim data Merged and Bias-corrected for ISIMIP (EWEMBI). GFZ Data Services.",c.a.createElement("a",{href:"http://doi.org/10.5880/pik.2016.004"},"http://doi.org/10.5880/pik.2016.004")),c.a.createElement("div",{style:{position:"absolute",left:"10px",bottom:"10px",fontSize:"1.5em"}},this.state.colorBuckets.map(function(e,t){return e.mm===1/0?null:c.a.createElement("div",null,c.a.createElement("div",{style:{display:"inline-block",marginRight:5,marginLeft:5,width:15,height:15,backgroundColor:"rgb("+255*e.rgb[0]+","+255*e.rgb[1]+","+255*e.rgb[2]+")"}}),e.mm," mm")},this)))}}]),n}(l.Component);t.a=w}).call(this,n(25).Buffer)},37:function(e,t,n){e.exports=n(102)},42:function(e,t,n){},44:function(e,t,n){}},[[37,2,1]]]);
//# sourceMappingURL=main.577e93fd.chunk.js.map